settings:
  name: "Passwords: Search for passwords in code"
  description: "Finding passwords and API keys in code exposes authentication credentials that can be exploited for unauthorized access. An attacker can use them to access email servers, version control systems, cloud services, or APIs, leading to data breaches, service disruptions, or further compromise of connected systems."
  image: debian
  author:
    - https://github.com/satorici
  gallery:
    - https://files.catbox.moe/9uipq3.png
  example: satori run ./ --playbook satori://secrets/passwords.yml --report --output

KEYWORD:
  - - "EMAIL_HOST_PASSWORD ="
    - "^password.*="
    - "GITHUB_TOKEN:"
    - "OPENAI_API_KEY=sk-"

secrets_passwords:
  assertStdout: False
  find:
    - grep "${{KEYWORD}}" * -R --exclude='*.md' -I | grep -v "secrets.GITHUB_TOKEN" | cut -b -200
