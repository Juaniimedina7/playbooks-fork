settings:
  name: "Gato-X: GitHub Attack Toolkit"
  description: A static analysis and exploit toolkit for GitHub Actions
  author: https://github.com/AdnaneKhan
  gallery:
  - https://files.catbox.moe/o7f9sf.png
  image: python
  cpu: 256
  memory: 512
  example: satori run satori://code/github/gato-x.yml -d GH_ACCESS_TOKEN=TBC -d REPO=udacity/deep-reinforcement-learning --output
  redacted: GH_ACCESS_TOKEN

install:
  - git clone --depth 1 https://github.com/AdnaneKhan/gato-x
  - cd gato-x; pip install . -q --disable-pip-version-check --root-user-action=ignore

gato-x:
  assertStdoutNotContains: HIGH
  run:
    - export GH_TOKEN=${{GH_ACCESS_TOKEN}}; gato-x e --repository ${{REPO}} 
