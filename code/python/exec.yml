settings:
  name: "Find Python command or code execution"
  description: "Search for strings that are used in Python to execute OS commands or Python code"
  image: debian
  author:
    - https://github.com/satorici
  gallery:
    - https://files.catbox.moe/p19cst.png
  example: satori run ./ --playbook="satori://code/python/exec.yml" --output

KEYWORD:
- - "pexpect.run"
  - "eval("
  - "exec("
  - "os\.system"
  - "os\.popen"
  - "execfile"
  - "subprocess\.Popen"
  - "subprocess\.call"

python_exec:
  assertStdout: False
  find:
    - grep "{{KEYWORD}}" * -r --include="*.py"
