settings:
  name: "Rust_Audit_Ginger: audit check performs an audit for crates with security vulnerabilities"
  description: "Checks Rust projects for security vulnerabilities and unsafe code. Uses cargo-audit to detect known security issues in dependencies and cargo-geiger to identify unsafe Rust code. Ensures no advisories or unsafe code patterns are present."
  image: rust
  files: true
  author:
    - https://github.com/rustsec
  gallery:
    - https://files.catbox.moe/8j9ajr.png
  example: satori run ./ satori://code/rust/geiger.yml --report --output

rust_geiger:
  install:
    - apt install -qy pkg-config libssl-dev >>/dev/null
    - cargo install cargo-geiger 2>>/dev/null

  help:
    - cargo geiger --help

  test:
    assertStdoutNotContains: "!  â”‚"
    setSeverity: 4
    run:
      - cargo geiger | tee geiger.txt
