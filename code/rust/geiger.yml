settings:
  name: "Rust_Geiger: check crates with security vulnerabilities"
  description: "Checks Rust projects for unsafe code"
  image: rust
  files: true
  author:
    - https://github.com/rustsec
  gallery:
    - https://files.catbox.moe/8j9ajr.png
  example: satori run ./ satori://code/rust/geiger.yml --report --output

rust_geiger:
  install:
    - apt install -qy pkg-config libssl-dev >>/dev/null
    - cargo install cargo-geiger 2>>/dev/null

  help:
    - cargo geiger --help

  test:
    assertStdoutNotContains: "!  â”‚"
    setSeverity: 4
    run:
      - cargo geiger | tee geiger.txt
