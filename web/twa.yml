settings:
  image: ubuntu:jammy
  name: "TWA: Tiny Web Auditor"
  description: "twa audits web security headers and configurations. It checks for issues such as HTTP redirects to HTTP, missing security headers, and the absence of Content-Security-Policy. Findings are categorized into levels to indicate severity and status."
  author:
    - https://github.com/trailofbits/twa
  gallery:
    - https://files.catbox.moe/vasexx.gif
  example: satori run satori://web/twa.yml -d HOST="satori.ci" --output

install:
  dependencies:
    - apt update >>/dev/null; apt install -qqy jq curl dnsutils netcat-traditional git
  clone:
    - git clone --depth 1 https://github.com/trailofbits/twa.git

twa:
  assertStdoutContains: FAIL
  run:
    - twa/twa -v ${{HOST}}
