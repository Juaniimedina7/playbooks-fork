settings:
  name: "sqlmap: automates the process of detecting and exploiting SQL injection flaws"
  image: python
  author:
    - https://github.com/sqlmapproject
  gallery:
    - https://files.catbox.moe/own9hv.gif
  example: satori run satori://web/sqlmap.yml -d URL="http://testphp.vulnweb.com/listproducts.php?cat=1" --report --output

sqlmap:
  install:
    - apt update >>/dev/null; apt install -qy git
    - cd /tmp; git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git

  help:
    - python3 /tmp/sqlmap/sqlmap.py -hh

  test:
    assertStdoutNotContains: "sqlmap identified the following injection point"
    run:
      - python3 /tmp/sqlmap/sqlmap.py -u ${{URL}}
