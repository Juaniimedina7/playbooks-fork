settings:
  image: golang
  name: "Puredns: domain resolver and subdomain bruteforcing tool that filters out wildcard subdomains and DNS poisoned entries"
  author:
    - https://github.com/blechschmidt
  gallery:
    - https://files.catbox.moe/2i78fz.png
  example: satori run satori://dns/puredns.yml -d DOMAIN="satori.ci" --output

install:
  dependencies:
    - apt update && apt install -y git make gcc
  massdns:
    - git clone https://github.com/blechschmidt/massdns.git; cd massdns && make
  puredns:
    - go install github.com/d3mondev/puredns/v2@latest
  input_file:
    - echo "${{DOMAIN}}" > input_file.txt


puredns:
  assertReturnCode: 0
  help:
    - puredns -h
  run:
    - puredns resolve input_file.txt --bin ./massdns/bin/massdns --resolvers ./massdns/lists/resolvers.txt
