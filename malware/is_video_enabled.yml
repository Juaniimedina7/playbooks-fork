settings:
  name: "Is_Video_Enabled: Checks if the video has been enabled by malware"
  description: "Checks if the uvcvideo module is loaded, indicating that video functionality has been enabled. Detects potential malware activity that secretly activates webcams for unauthorized surveillance or data collection."
  image: debian
  author:
    - https://github.com/satorici
  example: satori run satori://malware/is_video_enabled.yml --report --output

is_video_enabled:
  install:
    - apt-get update >> /dev/null; apt-get install -qy apt-utils >> /dev/null; apt-get install -qy kmod >> /dev/null

  test:
    assertReturnCode: 1
    assertStdout: False
    run:
      - /usr/sbin/lsmod | grep uvcvideo
