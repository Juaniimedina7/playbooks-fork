settings:
  name: "Yara: help malware researchers to identify and classify malware samples"
  description: "The Yara-Rules repository is a collaborative project that compiles, classifies, and maintains a comprehensive set of YARA rules for malware research and detection. The rules are organized into categories such as anti-debugging/anti-virtualization, capabilities, CVE detections, cryptography, exploit kits, malicious documents, malware, packers, web shells, email threats, and mobile malware. This structure aids security researchers in efficiently identifying and classifying various threats. The project operates under the GNU General Public License v2.0, encouraging contributions from the security community to keep the ruleset up-to-date."
  image: debian
  author:
    - https://github.com/Yara-Rules
  gallery:
    - https://files.catbox.moe/34jnvw.png
  example: satori run ./ --playbook="satori://malware/yara.yml" --report --output

yara:
  install:
    - apt update >>/dev/null; apt install -qy wget unzip yara >>/dev/null
    - wget -q https://github.com/Yara-Rules/rules/archive/master.zip -O/tmp/master.zip; cd /tmp; unzip -q /tmp/master.zip

  help:
    - yara -h

  test:
    assertStdout: False
    isSuspicious:
      - yara -w -r /tmp/rules-master/packers/packer_compiler_signatures.yar ./
    IP:
      - yara -w -r /tmp/rules-master/utils/ip.yar ./
