settings:
  name: "Search python functions assocaited to command executions and URL requests"
  description: "Searches Python code for functions related to command execution, URL requests, obfuscation, and password handling. Identifies potential security risks, including malware behavior, unauthorized system commands, data exfiltration, and credential exposure."
  image: debian
  author:
    - https://github.com/satorici
  gallery:
    - https://files.catbox.moe/7zjw5x.png
  example: satori run ./ --playbook satori://malware/python.yml --report --output

KEYWORD:
  suspicious:
    - - 'passw'
  obfuscation:
    - - 'b64decode('
      - 'b64encode('
  execution:
    - - 'subprocess.Popen'
      - 'os.system'
      - 'shell=True'
      - 'subprocess.getoutput('
  infilexfiltrate:
    - - 'requests.get('
      - 'urlretrieve('
      - 'urlopen('
      - 'requests\.Session('
      - 'requests\.post('

malware_python:
  assertStdout: False
  find:
    - grep "${{KEYWORD}}" * -R | cut -b -200
