settings:
  name: "Search python functions assocaited to command executions and URL requests"
  author:
    - https://github.com/satorici
  gallery:
    - https://files.catbox.moe/7zjw5x.png
  example: satori run ./ --playbook="satori://malware/python.yml" --report --output

strings:
  suspicious:
    - - 'passw'
  obfuscation:
    - - 'b64decode('
      - 'b64encode('
  execution:
    - - 'subprocess.Popen'
      - 'os.system'
      - 'shell=True'
      - 'subprocess.getoutput('
  infilexfiltrate:
    - - 'requests.get('
      - 'urlretrieve('
      - 'urlopen('
      - 'requests\.Session('
      - 'requests\.post('

python:
  assertStdout: False
  find:
  - grep "${{strings}}" * -R | cut -b -200
